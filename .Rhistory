prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
hist(prob)
fi = 0.15
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
fi = 0.2
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
hist(prob)
boxplot(prob~segmento)
fi = 0.5
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
fi = 0.5
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
fi = 0.1
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento)
tapply(logit_eta,segmento,mean)
tapply(prob,segmento,mean)
par(c(5,5))
pars(c(5,5))
par(c(5,5))
for (i in p.v){
plot(density(rbeta(N,i,0.1)))
}
p.v <- seq(0,1,by=0.1)
par(c(5,5))
for (i in p.v){
plot(density(rbeta(N,i,0.1)))
}
par(c(5,5))
for (i in p.v){
plot(density(rbeta(N,i,0.1)),main = paste("mu equal to",i,sep=""))
}
par(mfrow=c(5,5))
for (i in p.v){
plot(density(rbeta(N,i,0.1)),main = paste("mu equal to ",i,sep=""))
}
p.v <- seq(0,1,by=0.1)
p.v
par(mfrow=c(5,5))
for (i in p.v){
plot(density(rbeta(N,i,0.1)),main = paste("mu equal to ",i,sep=""))
}
plot(density(rbeta(N,i,0.1)),main = paste("mu equal to ",i,sep=""))
dev.off()
for (i in p.v){
plot(density(rbeta(N,i,0.1)),main = paste("mu equal to ",i,sep=""))
}
for (i in p.v){
plot(density(rbeta(N,i,0)),main = paste("mu equal to ",i,sep=""))
}
for (i in p.v){
plot(density(rbeta(N,i,1)),main = paste("mu equal to ",i,sep=""))
}
for (i in p.v){
plot(density(rbeta(N,i,2)),main = paste("mu equal to ",i,sep=""))
}
fi = 2
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
boxplot(prob~segmento)
hist(prob)
tapply(prob,segmento,mean)
fi = 1
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
i1 <- -0.5/2
i2 <- -0.5/2
i3 <- -0.8/2
i4 <- -0.8/2
i5 <- -1/2
i6 <- -1/2
betas = rbind(b0,b1,b2,b3,b4,
b5,b6,b7,
i1,i2,i3,i4,i5,i6
)
betas
X = data.frame(X0=1,X1=n.deuda,X2=roe,X3=roa,X4=amortiza$flag_npago,
X5=activos,X6=pasivos,X7=ebitda,
I1=amortiza$P1,I2=amortiza$P2,I3=amortiza$P3,I4=amortiza$P4,
I5=amortiza$P5,I6=amortiza$P6)
hist(X$X1*b1)
hist(X$X2*b2)
hist(X$X3*b3)
hist(X$X4*b4)
hist(X$X5*b5)
hist(X$X6*b6)
hist(X$X7*b7)
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
hist(X$X1*b1)
hist(X$X2*b2)
hist(X$X3*b3)
hist(X$X4*b4)
hist(X$X5*b5)
hist(X$X6*b6)
hist(X$X7*b7)
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
logit_eta <- 1 / (1 + exp(  (eta) ) )
hist(logit_eta)
X$logit_eta <- logit_eta
head( X[X$logit_eta<0.9 & X$logit_eta>0.6,] , 10)
fi = 1
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
boxplot(prob~segmento)
fi = 1.5
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 3
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.05
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.1
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.15
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.18
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.2
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.5
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
prob=double(N)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
boxplot(prob~segmento)
hist(prob)
y = ifelse( prob > 0.8, 1, 0)
X$y <- y
head(X_beta[X$X4 == 0 & X$y ==1 & X$eta > 0,],10)
X_beta <- cbind(id,
X$X0 * betas[1],
X$X1 * betas[2],
X$X2 * betas[3],
X$X3 * betas[4],
X$X4 * betas[5],
X$X5 * betas[6],
X$X6 * betas[7],
X$X7 * betas[8],
X$I1 * betas[9],
X$I2 * betas[10],
X$I3 * betas[11],
X$I4 * betas[12],
X$I5 * betas[13],
X$I6 * betas[14],
X$eta,
X$logit_eta,
y
)
summary(as.factor(y))
tapply(prob,segmento,mean)
fi = 0.8
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 1
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
fi = 0.5
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
hist(logit_eta)
i1 <- -0.5
i2 <- -0.5
i3 <- -0.8
i4 <- -0.8
i5 <- -1
i6 <- -1
betas = rbind(b0,b1,b2,b3,b4,
b5,b6,b7,
i1,i2,i3,i4,i5,i6
)
betas
X = data.frame(X0=1,X1=n.deuda,X2=roe,X3=roa,X4=amortiza$flag_npago,
X5=activos,X6=pasivos,X7=ebitda,
I1=amortiza$P1,I2=amortiza$P2,I3=amortiza$P3,I4=amortiza$P4,
I5=amortiza$P5,I6=amortiza$P6)
hist(X$X1*b1)
hist(X$X2*b2)
hist(X$X3*b3)
hist(X$X4*b4)
hist(X$X5*b5)
hist(X$X6*b6)
hist(X$X7*b7)
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
logit_eta <- 1 / (1 + exp(  (eta) ) )
hist(logit_eta)
hist(logit_eta)
b0 <- 4
b1 <- -0.5 #Nivel de endeudamiento
b2 <- 4 #ROE
b3 <- 4 #ROA
b4 <- -10 #FACTOR K NO PAGOS
b5 <-  1/ c(pesos %*% factores) * 1 /75
b6 <- (- 1/ c(pesos %*% factores)) * (5/(5+4)) * 1 / 40
b7 <- (( 1/ c(pesos %*% factores)) / (4/(5+4)))  / (5/(5+5))  * 1/75
i1 <- -0.5
i2 <- -0.5
i3 <- -0.8
i4 <- -0.8
i5 <- -1
i6 <- -1
betas = rbind(b0,b1,b2,b3,b4,
b5,b6,b7,
i1,i2,i3,i4,i5,i6
)
betas
X = data.frame(X0=1,X1=n.deuda,X2=roe,X3=roa,X4=amortiza$flag_npago,
X5=activos,X6=pasivos,X7=ebitda,
I1=amortiza$P1,I2=amortiza$P2,I3=amortiza$P3,I4=amortiza$P4,
I5=amortiza$P5,I6=amortiza$P6)
hist(X$X1*b1)
hist(X$X2*b2)
hist(X$X3*b3)
hist(X$X4*b4)
hist(X$X5*b5)
hist(X$X6*b6)
hist(X$X7*b7)
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
logit_eta <- 1 / (1 + exp(  (eta) ) )
hist(logit_eta)
b1 <- -0.3 #Nivel de endeudamiento
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
b1 <- -0.25 #Nivel de endeudamiento
b2 <- 4 #ROE
b3 <- 4 #ROA
b4 <- -10 #FACTOR K NO PAGOS
b5 <-  1/ c(pesos %*% factores) * 1 /75
b6 <- (- 1/ c(pesos %*% factores)) * (5/(5+4)) * 1 / 40
b7 <- (( 1/ c(pesos %*% factores)) / (4/(5+4)))  / (5/(5+5))  * 1/75
i1 <- -0.5
i2 <- -0.5
i3 <- -0.8
i4 <- -0.8
i5 <- -1
i6 <- -1
betas = rbind(b0,b1,b2,b3,b4,
b5,b6,b7,
i1,i2,i3,i4,i5,i6
)
betas
X = data.frame(X0=1,X1=n.deuda,X2=roe,X3=roa,X4=amortiza$flag_npago,
X5=activos,X6=pasivos,X7=ebitda,
I1=amortiza$P1,I2=amortiza$P2,I3=amortiza$P3,I4=amortiza$P4,
I5=amortiza$P5,I6=amortiza$P6)
hist(X$X1*b1)
hist(X$X2*b2)
hist(X$X3*b3)
hist(X$X4*b4)
hist(X$X5*b5)
hist(X$X6*b6)
hist(X$X7*b7)
eta <-  (as.matrix(X) %*% betas)
X$eta <- eta
hist(eta)
logit_eta <- 1 / (1 + exp(  (eta) ) )
hist(logit_eta)
X$logit_eta <- logit_eta
head( X[X$logit_eta<0.9 & X$logit_eta>0.6,] , 10)
fi = 0.5
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
boxplot(prob~segmento)
boxplot(logit_eta~segmento)
boxplot(logit_eta~segmento
,ylim=c(0,0.1))
hist(prob)
tapply(prob,segmento,mean)
y = ifelse( prob > 0.8, 1, 0)
X$y <- y
summary(as.factor(y))
summary(as.factor(y))
boxplot(logit_eta~segmento
,ylim=c(0,0.1))
boxplot(logit_eta~segmento
# ,ylim=c(0,0.1)
)
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
for (i in 1:N) {
prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
}
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
y = ifelse( prob > 0.8, 1, 0)
X$y <- y
summary(as.factor(y))
y = ifelse( prob > 0.8, 1, 0)
X$y <- y
summary(as.factor(y))
sum(X$X4)
X_beta <- cbind(id,
X$X0 * betas[1],
X$X1 * betas[2],
X$X2 * betas[3],
X$X3 * betas[4],
X$X4 * betas[5],
X$X5 * betas[6],
X$X6 * betas[7],
X$X7 * betas[8],
X$I1 * betas[9],
X$I2 * betas[10],
X$I3 * betas[11],
X$I4 * betas[12],
X$I5 * betas[13],
X$I6 * betas[14],
X$eta,
X$logit_eta,
y
)
X_beta[X$X4 == 1,]
X_beta[X$X4 == 1,"logit_eta"]
X_beta[X$X4 == 1,c("logit_eta")]
dim(X_beta)
X_beta[X$X4 == 1,c(17,18)]
X_beta[X$X4 == 1 & X$y == 0,c(17,18)]
summary(X_beta[X$X4 == 1 & X$y == 0,c(17,18)])
fi = 0.4
# par(mfrow=c(5,5))
p.v <- seq(0,1,by=0.1)
for (i in p.v){
plot(density(rbeta(N,i,fi)),main = paste("mu equal to ",i,sep=""))
}
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
prob[i] = logit_eta[i]/(logit_eta[i] + fi)
}
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
fi = 0.1
prob=double(N)
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = qbeta(0.5,shape1 = logit_eta[i],shape=fi)
prob[i] = logit_eta[i]/(logit_eta[i] + fi)
}
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
tapply(prob,segmento,mean)
?qbeta
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
prob[i] = dbeta(0.5,shape1 = logit_eta[i],shape=fi)
# prob[i] = logit_eta[i]/(logit_eta[i] + fi)
}
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
fi = 0.1
prob=double(N)
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
prob[i] = dbeta(0.5,shape1 = logit_eta[i],shape=fi)
# prob[i] = logit_eta[i]/(logit_eta[i] + fi)
}
segmento_ne_1 <- segmento != "1"
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
for (i in 1:N) {
# prob[i] = rbeta(1,shape1 = logit_eta[i],shape=fi)
# prob[i] = dbeta(0.5,shape1 = logit_eta[i],shape=fi)
prob[i] = logit_eta[i]/(logit_eta[i] + fi)
}
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
y = ifelse( prob > 0.7, 1, 0)
X$y <- y
summary(as.factor(y))
sum(X$X4)
X_beta <- cbind(id,
X$X0 * betas[1],
X$X1 * betas[2],
X$X2 * betas[3],
X$X3 * betas[4],
X$X4 * betas[5],
X$X5 * betas[6],
X$X6 * betas[7],
X$X7 * betas[8],
X$I1 * betas[9],
X$I2 * betas[10],
X$I3 * betas[11],
X$I4 * betas[12],
X$I5 * betas[13],
X$I6 * betas[14],
X$eta,
X$logit_eta,
X$y
)
abline(v=0.6,col=2)
abline(h=0.6,col=2)
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
abline(h=0.6,col=2)
boxplot(prob~segmento
# ,ylim=c(0,0.1)
)
abline(h=0.6,col=2,lty=2)
rates
calculo(1)
hist(prob)
